# ะะฐัะฟัะตะดะตะปัะฝะฝะฐั ะผะฐัััััะธะทะฐัะธั ะผะพะดะตะปะตะน

AILLM ะฟะพะดะดะตัะถะธะฒะฐะตั **ัะฐัะฟัะตะดะตะปัะฝะฝัะน ัะตะถะธะผ ัะฐะฑะพัั** ั ะฝะตัะบะพะปัะบะธะผะธ Ollama ัะตัะฒะตัะฐะผะธ. ะกะธััะตะผะฐ ะฐะฒัะพะผะฐัะธัะตัะบะธ ะฒัะฑะธัะฐะตั ะพะฟัะธะผะฐะปัะฝัะน ัะตัะฒะตั ะดะปั ะบะฐะถะดะพะณะพ ะทะฐะฟัะพัะฐ ะฝะฐ ะพัะฝะพะฒะต:

- ะะฐะปะธัะธั ะฝัะถะฝะพะน ะผะพะดะตะปะธ ะฝะฐ ัะตัะฒะตัะต
- ะัะธะพัะธัะตัะฐ ัะตัะฒะตัะฐ
- ะัะตะผะตะฝะธ ะพัะบะปะธะบะฐ
- ะขะธะฟะฐ ะทะฐะดะฐัะธ ะธ ััะตะฑัะตะผะพะน ัะปะพะถะฝะพััะธ

## ๐๏ธ ะััะธัะตะบัััะฐ

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                     AILLM Backend                           โ
โ                                                             โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ   โ
โ  โ              ResourceAwareSelector                   โ   โ
โ  โ                                                      โ   โ
โ  โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ    โ   โ
โ  โ  โ        DistributedModelRouter               โ    โ   โ
โ  โ  โ                                             โ    โ   โ
โ  โ  โ  โข ะะฑะฝะฐััะถะตะฝะธะต ัะตัะฒะตัะพะฒ                     โ    โ   โ
โ  โ  โ  โข ะะฝะดะตะบัะฐัะธั ะผะพะดะตะปะตะน                       โ    โ   โ
โ  โ  โ  โข ะะฐัััััะธะทะฐัะธั ะทะฐะฟัะพัะพะฒ                   โ    โ   โ
โ  โ  โ  โข Failover ะธ fallback                      โ    โ   โ
โ  โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ    โ   โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ   โ
โ                              โ                              โ
โ              โโโโโโโโโโโโโโโโโดโโโโโโโโโโโโโโโโ              โ
โ              โผ                               โผ              โ
โ   โโโโโโโโโโโโโโโโโโโโโโโ       โโโโโโโโโโโโโโโโโโโโโโโ    โ
โ   โ  Remote Server      โ       โ  localhost          โ    โ
โ   โ  (GPU: 3x RTX 3090) โ       โ  (CPU only)         โ    โ
โ   โ                     โ       โ                     โ    โ
โ   โ  โข llama3.3:70b     โ       โ  โข gemma3:1b        โ    โ
โ   โ  โข gemma3:12b       โ       โ  โข qwen2.5:1.5b     โ    โ
โ   โ  โข qwen2.5-coder:14bโ       โ  โข phi3:3b          โ    โ
โ   โ  โข qwen3:14b        โ       โ                     โ    โ
โ   โโโโโโโโโโโโโโโโโโโโโโโ       โโโโโโโโโโโโโโโโโโโโโโโ    โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

## โ๏ธ ะะพะฝัะธะณััะฐัะธั

ะะปั ะฒะบะปััะตะฝะธั ัะฐัะฟัะตะดะตะปัะฝะฝะพะณะพ ัะตะถะธะผะฐ ะดะพะฑะฐะฒััะต ะฒ `backend/config/config.yaml`:

```yaml
llm:
  providers:
    ollama:
      enabled: true
      
      # ะัะฝะพะฒะฝะพะน ัะตัะฒะตั (ะผะพัะฝัะน GPU ัะตัะฒะตั)
      base_url: http://192.168.178.126:11434
      
      # ะะตะทะตัะฒะฝัะต URL
      fallback_urls:
        - ollama-server.local:11434  # mDNS
        - ollama.local:11434
      
      # ะะพะฟะพะปะฝะธัะตะปัะฝัะต ัะตัะฒะตัั
      additional_servers:
        - name: localhost
          url: http://localhost:11434
          priority: SECONDARY
        
        - name: backup_gpu
          url: http://192.168.178.200:11434
          priority: FALLBACK
      
      # ะะบะปััะธัั ัะฐัะฟัะตะดะตะปัะฝะฝัะน ัะตะถะธะผ
      distributed_mode: true
      
      # ะะฒัะพ-ะพะฑะฝะฐััะถะตะฝะธะต (ะพะฟัะธะพะฝะฐะปัะฝะพ)
      auto_discover: true
```

### ะัะธะพัะธัะตัั ัะตัะฒะตัะพะฒ

| ะัะธะพัะธัะตั | ะะฟะธัะฐะฝะธะต | ะัะฟะพะปัะทะพะฒะฐะฝะธะต |
|-----------|----------|---------------|
| `PRIMARY` | ะัะฝะพะฒะฝะพะน ัะตัะฒะตั | ะะปั ะฒัะตั ะทะฐะดะฐั ะฟะพ ัะผะพะปัะฐะฝะธั |
| `SECONDARY` | ะัะพัะธัะฝัะน ัะตัะฒะตั | ะะปั fallback ะธะปะธ ัะฟะตัะธัะธัะฝัั ะทะฐะดะฐั |
| `FALLBACK` | ะะตะทะตัะฒะฝัะน | ะขะพะปัะบะพ ะตัะปะธ ะดััะณะธะต ะฝะตะดะพัััะฟะฝั |

## ๐ ะะพะณะธะบะฐ ะผะฐัััััะธะทะฐัะธะธ

### 1. ะัะพัััะต ะทะฐะดะฐัะธ (trivial/simple)

```
ะะพะปัะทะพะฒะฐัะตะปั: "ะัะธะฒะตั!"

1. ะะฟัะตะดะตะปัะตะผ ัะปะพะถะฝะพััั โ trivial
2. ะัะถะฝะฐ ะฑััััะฐั ะผะพะดะตะปั (gemma3:1b, qwen2.5:1.5b)
3. ะัะตะผ ะฝะฐ ะฒัะตั ัะตัะฒะตัะฐั:
   - localhost: ะตััั gemma3:1b โ
   - remote: ะตััั gemma3:12b (ัะปะธัะบะพะผ ะฑะพะปััะฐั)
4. ะัะฑะธัะฐะตะผ: gemma3:1b @ localhost
```

### 2. ะกัะตะดะฝะธะต ะทะฐะดะฐัะธ (moderate)

```
ะะพะปัะทะพะฒะฐัะตะปั: "ะะฑัััะฝะธ ะฟะฐััะตัะฝ Singleton"

1. ะะฟัะตะดะตะปัะตะผ ัะปะพะถะฝะพััั โ moderate
2. ะัะถะฝะฐ balanced ะผะพะดะตะปั (gemma3:12b, qwen2.5:14b)
3. ะัะตะผ ะฝะฐ ะฒัะตั ัะตัะฒะตัะฐั:
   - localhost: ัะพะปัะบะพ ะผะฐะปะตะฝัะบะธะต ะผะพะดะตะปะธ
   - remote: ะตััั gemma3:12b โ
4. ะัะฑะธัะฐะตะผ: gemma3:12b @ remote
```

### 3. ะกะปะพะถะฝัะต ะทะฐะดะฐัะธ (complex)

```
ะะพะปัะทะพะฒะฐัะตะปั: "ะะฐะฟะธัะธ ัะธััะตะผั ะฐะฒัะพัะธะทะฐัะธะธ ั JWT, refresh tokens ะธ rate limiting"

1. ะะฟัะตะดะตะปัะตะผ ัะปะพะถะฝะพััั โ complex
2. ะัะถะฝะฐ ะผะพัะฝะฐั ะผะพะดะตะปั (qwen2.5-coder:14b, llama3.3:70b)
3. ะัะตะผ ะฝะฐ ะฒัะตั ัะตัะฒะตัะฐั:
   - localhost: ะฝะตั ะผะพัะฝัั ะผะพะดะตะปะตะน
   - remote: ะตััั qwen2.5-coder:14b โ
4. ะัะฑะธัะฐะตะผ: qwen2.5-coder:14b @ remote
```

### 4. Fallback

```
ะะพะปัะทะพะฒะฐัะตะปั: "ะะฐะฟะธัะธ..." (remote ัะตัะฒะตั ะฝะตะดะพัััะฟะตะฝ)

1. ะัะพะฑัะตะผ remote โ timeout
2. ะัะตะผ ะฐะปััะตัะฝะฐัะธะฒั ะฝะฐ ะดะพัััะฟะฝัั ัะตัะฒะตัะฐั
3. localhost: ะตััั qwen2.5:1.5b (ะผะตะฝััะต, ะฝะพ ัะฐะฑะพัะฐะตั)
4. ะัะฑะธัะฐะตะผ: qwen2.5:1.5b @ localhost
5. ะัะตะดัะฟัะตะถะดะฐะตะผ: "ะัะฟะพะปัะทัะตััั ัะฟัะพััะฝะฝะฐั ะผะพะดะตะปั"
```

## ๐ ะกัะตะฝะฐัะธะธ ะธัะฟะพะปัะทะพะฒะฐะฝะธั

### ะกัะตะฝะฐัะธะน 1: ะะพัะฝัะน GPU ัะตัะฒะตั + ะฝะพััะฑัะบ

**ะะพะฝัะธะณััะฐัะธั:**
- Remote: 12900K + 3x RTX 3090 (72GB VRAM)
- Localhost: MacBook (ะฑะตะท GPU)

**ะะฐัะฟัะตะดะตะปะตะฝะธะต:**
| ะะฐะดะฐัะฐ | ะะพะดะตะปั | ะกะตัะฒะตั |
|--------|--------|--------|
| ะัะธะฒะตั, ัััะบะธ | gemma3:1b | localhost |
| ะะฑัััะฝะตะฝะธั | gemma3:12b | remote |
| ะะพะด | qwen2.5-coder:14b | remote |
| Reasoning | llama3.3:70b | remote |

### ะกัะตะฝะฐัะธะน 2: ะะฒะฐ GPU ัะตัะฒะตัะฐ

**ะะพะฝัะธะณััะฐัะธั:**
- Server A: RTX 3090 (24GB) โ ะบะพะด
- Server B: RTX 4090 (24GB) โ ัะฐั

**ะะฐัะฟัะตะดะตะปะตะฝะธะต:**
```yaml
additional_servers:
  - name: code_server
    url: http://192.168.178.100:11434
    priority: PRIMARY
  - name: chat_server
    url: http://192.168.178.101:11434
    priority: PRIMARY
```

ะกะธััะตะผะฐ ะฐะฒัะพะผะฐัะธัะตัะบะธ ะฒัะฑะตัะตั ัะตัะฒะตั ั ะฝัะถะฝะพะน ะผะพะดะตะปัั ะดะปั ัะธะฟะฐ ะทะฐะดะฐัะธ.

### ะกัะตะฝะฐัะธะน 3: ะขะพะปัะบะพ localhost

ะัะปะธ `distributed_mode: false` ะธะปะธ ัะพะปัะบะพ ะพะดะธะฝ ัะตัะฒะตั โ ัะฐะฑะพัะฐะตั ะฒ ะพะฑััะฝะพะผ ัะตะถะธะผะต.

## ๐๏ธ API Metadata

ะ ะพัะฒะตัะฐั API ะดะพะฑะฐะฒะปัะตััั ะธะฝัะพัะผะฐัะธั ะพ ะผะฐัััััะธะทะฐัะธะธ:

```json
{
  "success": true,
  "message": "ะัะธะฒะตั! ๐",
  "metadata": {
    "model": "gemma3:1b",
    "provider": "ollama",
    "distributed_routing": true,
    "server_used": "http://localhost:11434",
    "complexity_level": "trivial",
    "used_fast_model": true
  }
}
```

## ๐ ะะธะฐะณะฝะพััะธะบะฐ

### ะัะพะฒะตัะบะฐ ะดะพัััะฟะฝะพััะธ ัะตัะฒะตัะพะฒ

```bash
# ะัะฝะพะฒะฝะพะน ัะตัะฒะตั
curl http://192.168.178.126:11434/api/tags

# Localhost
curl http://localhost:11434/api/tags
```

### ะะพะณะธ

ะ ะปะพะณะฐั AILLM:
```
INFO - Discovering Ollama servers and models...
INFO - Server primary (http://192.168.178.126:11434): 15 models, 45ms
INFO - Server localhost (http://localhost:11434): 3 models, 5ms
INFO - Discovery complete: 2/2 servers available, 18 unique models
INFO - Distributed routing: gemma3:1b @ localhost (fallback: False)
```

### Endpoint ะดะปั ััะฐัััะฐ

```bash
# ะะพะปััะธัั ััะฐััั ะฒัะตั ัะตัะฒะตัะพะฒ (ะตัะปะธ ัะตะฐะปะธะทะพะฒะฐะฝ)
curl http://localhost:8000/api/models/servers
```

## โ๏ธ ะะณัะฐะฝะธัะตะฝะธั

1. **ะกะตััะธะธ ะฝะต ัะธะฝััะพะฝะธะทะธัััััั** โ ะบะฐะถะดัะน ะทะฐะฟัะพั ะฝะตะทะฐะฒะธัะธะผ
2. **ะะพะฝัะตะบัั ะผะพะดะตะปะธ** โ ะฟัะธ ะฟะตัะตะบะปััะตะฝะธะธ ะผะตะถะดั ัะตัะฒะตัะฐะผะธ ะบะพะฝัะตะบัั ัะตััะตััั
3. **Latency** โ ะทะฐะฟัะพั ะบ ัะดะฐะปัะฝะฝะพะผั ัะตัะฒะตัั ะผะตะดะปะตะฝะฝะตะต ะปะพะบะฐะปัะฝะพะณะพ
4. **Network** โ ััะตะฑัะตััั ััะฐะฑะธะปัะฝะพะต ัะตัะตะฒะพะต ัะพะตะดะธะฝะตะฝะธะต

## ๐ก ะะตะบะพะผะตะฝะดะฐัะธะธ

1. **ะะฐะทะดะตะปัะนัะต ะผะพะดะตะปะธ ะปะพะณะธัะตัะบะธ:**
   - localhost: ะฑัััััะต ะผะพะดะตะปะธ ะดะปั ััะธะฒะธะฐะปัะฝัั ะทะฐะดะฐั
   - remote: ะผะพัะฝัะต ะผะพะดะตะปะธ ะดะปั ัะปะพะถะฝัั ะทะฐะดะฐั

2. **ะัะฟะพะปัะทัะนัะต mDNS** ะดะปั ะดะธะฝะฐะผะธัะตัะบะธั IP (ัะผ. `dynamic_server_solution.md`)

3. **ะะพะฝะธัะพัััะต ะปะพะณะธ** ะดะปั ะฒััะฒะปะตะฝะธั ะฟัะพะฑะปะตะผ ะผะฐัััััะธะทะฐัะธะธ

4. **ะะฐัััะพะนัะต ะฟัะธะพัะธัะตัั** ะฟัะฐะฒะธะปัะฝะพ:
   - PRIMARY ะดะปั ะพัะฝะพะฒะฝะพะณะพ GPU ัะตัะฒะตัะฐ
   - SECONDARY ะดะปั localhost (ะฑัััััะต ะผะพะดะตะปะธ)
   - FALLBACK ะดะปั ัะตะทะตัะฒะฝัั ัะตัะฒะตัะพะฒ

